import 'dotenv/config' // TODO - test env
import { AfterAll, BeforeAll, expect, FTest, FTestSuite, Test, TestSuite } from 'testyts';
import LndHandler, { LoadLndSettingsFromEnv } from '.'
import * as Types from '../../../proto/autogenerated/ts/types';
@TestSuite()
export class LndTestSuite {
    lnd: LndHandler
    @BeforeAll()
    async createLnd() {
        this.lnd = new LndHandler(LoadLndSettingsFromEnv(true), console.log, console.log)
        await this.lnd.Warmup()
    }
    @AfterAll()
    stopStreams() {
    }
    @Test()
    async getAlias() {
        const res = await this.lnd.GetInfo()
        expect.toBeEqual(res.alias, "alice")
    }
    @Test()
    async newAddress() {
        const res = await this.lnd.NewAddress(Types.AddressType.WITNESS_PUBKEY_HASH)
        console.log(res)
    }
    @Test()
    async newInvoice() {
        const res = await this.lnd.NewInvoice(1000)
        console.log(res)
    }
    @FTest()
    async estimateFees() {
        const res = await this.lnd.EstimateChainFees("bcrt1qajzzx453x9fx5gtlyax8zrsennckrw3syd2llt", 1000, 100)
        console.log(res)
    }

    @Test()
    async openChannel() {
        //const res = await this.lnd.OpenChannel("025ed7fc85fc05a07fc5acc13a6e3836cd11c5587c1d400afcd22630a9e230eb7a", "", 20000, 0)
    }

}